function e(e,t,a,o){Object.defineProperty(e,t,{get:a,set:o,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},o={},r=t.parcelRequire0e29;null==r&&((r=function(e){if(e in a)return a[e].exports;if(e in o){var t=o[e];delete o[e];var r={id:e,exports:{}};return a[e]=r,t.call(r.exports,r,r.exports),r.exports}var l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,t){o[e]=t},t.parcelRequire0e29=r),r.register("bXuNP",(function(t,a){var o,r;e(t.exports,"register",(()=>o),(e=>o=e)),e(t.exports,"resolve",(()=>r),(e=>r=e));var l={};o=function(e){for(var t=Object.keys(e),a=0;a<t.length;a++)l[t[a]]=e[t[a]]},r=function(e){var t=l[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r("bXuNP").register(JSON.parse('{"2JFQr":"index.3d4ba95d.js","bJmGX":"rtw.db725a81.js","7WKo9":"rtw-trello.edaa1442.js","cX2tx":"spotify.1e0f0708.js","irEM1":"spotify-trello.00774160.js","2Ywgl":"swm.415b8913.js","cHbDk":"princeton.82973572.js","kzChq":"index.1cad1fc6.js"}'));var l=r("LdkDU");const n=async e=>[{text:"Challenge Toolbox",callback:e=>(async e=>{const t=await e.get(l.default.Scope.Board,l.default.Visibility.Shared,l.default.Key.ChallengePreferences);return e.popup({title:"Toolbox preferences",url:"./board-buttons-popup-authors.html",args:{myArgs:t}})})(e),condition:l.default.Condition.Always}];l=r("LdkDU");var s=r("BvQ1f");const i=(e,t)=>(async e=>{const t=l.default.Scope.Card,a=l.default.Visibility.Shared,o=l.default.Key.LogEntries,r=l.default.Capability.CardBadges,n=await e.get(t,a,o);console.log(`Data stored for ${o} against ${t} with ${a} access for ${r}  : `,n);const i=e.getContext();console.log("Context for card badges: ",i);const{challenges:c,celebrations:d}=s.default.getChallengeBadgeCounts(i,n),u=s.default.getButtonText(l.default.Type.Challenge,c),f=s.default.getButtonText(l.default.Type.Celebrate,d);if(console.log(`Current value for ${o} for card-badges`,n),0===c&&0===d)return[];const g=[{text:u,color:"red"},{text:f,color:"green"}],p=[];return 0!==c&&p.push(g[0]),0!==c&&p.push(g[1]),e.card("id","name").then((function(e){return p}))})(e);l=r("LdkDU"),s=r("BvQ1f");const c=(e,t)=>(async e=>{const t=l.default.Scope.Card,a=l.default.Visibility.Shared,o=l.default.Key.LogEntries,r=l.default.Capability.CardButtons,n=await e.get(t,a,o);console.log(`Data stored for ${o} against ${t} with ${a} access for ${r}  : `,n);const i=e.getContext();console.log("Context for card badges: ",i);const{challenges:c,celebrations:d}=s.default.getChallengeBadgeCounts(i,n),u=s.default.getButtonText(l.default.Type.Challenge,c),f=s.default.getButtonText(l.default.Type.Celebrate,d),g=e=>{console.log("onCloseChallengToolbox")},p=await e.card("name").get("name");return console.log("card: ",JSON.stringify(p,null,2)),[{icon:"https://cdn.hyperdev.com/us-east-1%3A3d31b21c-01a0-4da2-8827-4bc6e88b7618%2Ficon-gray.svg",text:u,condition:l.default.Condition.Always,callback:function(e){return e.modal({title:"Challenge",args:{type:l.default.Type.Challenge},url:"./modals/challenge.html",fullscreen:!1,height:500,callback:g})}},{icon:"https://cdn.hyperdev.com/us-east-1%3A3d31b21c-01a0-4da2-8827-4bc6e88b7618%2Ficon-gray.svg",text:f,condition:l.default.Condition.Always,callback:function(e){return e.modal({title:"Celebrate",args:{type:l.default.Type.Celebrate},url:"./modals/celebrate.html",fullscreen:!1,height:500})}}]})(e);l=r("LdkDU");r("bDs4w");s=r("BvQ1f"),l=r("LdkDU");var d={Authors:Object.freeze({RTW:"rtw",Spotify:"spotify",SWM:"swm",PrinciplesGreen:"pg",Princeton:"princeton"}),Environments:Object.freeze({Trello:"Trello"})};r.register("1L4ef",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("bJmGX")).then((()=>r("b6NUa")))})),r.register("aL8Qr",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("7WKo9")).then((()=>r("bEksa")))})),r.register("aHNJm",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("cX2tx")).then((()=>r("bmO0s")))})),r.register("hL96R",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("irEM1")).then((()=>r("f1e8W")))})),r.register("4Fu9l",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("2Ywgl")).then((()=>r("ffvez")))})),r.register("MsWMT",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("cHbDk")).then((()=>r("epFvb")))}));const u=async e=>{let t,a;return(async()=>{switch(e){case d.Authors.RTW:return t=await r("1L4ef"),a=await r("aL8Qr"),{...t,...a};case d.Authors.Spotify:return t=await r("aHNJm"),a=await r("hL96R"),{...t,...a};case d.Authors.SWM:return t=await r("4Fu9l"),{...t,...a};case d.Authors.Princeton:return t=await r("MsWMT"),{...t,...a}}})()};var f={getTrelloData:async e=>{const t=e.id;return await u(t)},getAuthorDataById:u};var g={getData:async e=>await f.getAuthorDataById(e.id),getCapabilityPreferences:(e,t)=>{const a=e.capabilities.find((e=>e.capability===t));return a&&a.enabled?a.labels:[]},getTrelloLabels:async({pledges:e,log:t,context:a,popup:o=null})=>(console.log("getTrelloLabels log: ",t),o?e.map((e=>({text:`${e.text} ${s.default.getCustomBadgeCounts(a,t,e)}`,condition:l.default.Condition.Always,callback:e=>((e,t,a)=>e.popup({title:a.prompt,items:a.effects}))(e,0,o)}))):e.map((e=>({text:e.text,condition:l.default.Condition.Always,callback:t=>(async(e,t,a)=>{const o=new s.default,{isPledgeNowLogged:r,updatedPledges:l}=o.togglePledge(t,a);return await e.set(scope,visibility,key,l),await e.get(scope,visibility,key)})(t,a,e)})))),getPopup:async e=>{const t=e.popup;return!t||t&&!t.enabled?null:t}};const p=(e,t)=>(async e=>{const t=e.getContext(),a=await e.get(l.default.Scope.Card,l.default.Visibility.Shared,l.default.Key.LogEntries);let o;a&&void 0!==a&&(o=challengeLog.setLog(a));const r=await e.get(l.default.Scope.Board,l.default.Visibility.Shared,l.default.Key.ChallengePreferences),n=await g.getData(r),s=await g.getCapabilityPreferences(n,l.default.Capability.CardDetailBadges);return await g.getTrelloLabels({pledges:s,log:o,context:{board:t.board,card:t.card,member:t.member}})})(e);window.TrelloPowerUp.initialize({"board-buttons":(e,t)=>n(),"card-badges":(e,t)=>i(e),"card-buttons":(e,t)=>c(e),"card-detail-badges":(e,t)=>p(e)});
//# sourceMappingURL=index.3d4ba95d.js.map
