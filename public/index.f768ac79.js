function e(e,t,a,o){Object.defineProperty(e,t,{get:a,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},n={},r=a.parcelRequire0e29;null==r&&((r=function(e){if(e in o)return o[e].exports;if(e in n){var t=n[e];delete n[e];var a={id:e,exports:{}};return o[e]=a,t.call(a.exports,a,a.exports),a.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){n[e]=t},a.parcelRequire0e29=r),r.register("bXuNP",(function(t,a){var o,n;e(t.exports,"register",(()=>o),(e=>o=e)),e(t.exports,"resolve",(()=>n),(e=>n=e));var r={};o=function(e){for(var t=Object.keys(e),a=0;a<t.length;a++)r[t[a]]=e[t[a]]},n=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r("bXuNP").register(JSON.parse('{"2JFQr":"index.f768ac79.js","bJmGX":"rtw.db725a81.js","7WKo9":"rtw-trello.edaa1442.js","cX2tx":"spotify.1e0f0708.js","irEM1":"spotify-trello.00774160.js","2Ywgl":"swm.415b8913.js","cHbDk":"princeton.82973572.js","kzChq":"index.b7389a8e.js"}'));var l=r("LdkDU");r("BvQ1f");var i;i=JSON.parse('{"authors":[{"id":"rtw","name":"ResponsibleTech.Work","title":"ResponsibleTech.Work Pledges"},{"id":"spotify","name":"Spotify","title":"Spotify Ethics Assessment"},{"id":"swm","name":"Sustainable Web Manifesto","title":"Sustainable Web Manifesto"},{"id":"pg","name":"Principles.Green","title":"Principles of Green Software Engineering"},{"id":"princeton","name":"Princeton web transparency","title":"Dark Patterns at Scale"}]}');const s=async e=>{const a=l.default.Scope.Board,o=l.default.Visibility.Shared,n=l.default.Key.ChallengePreferences,r=(l.default.Capability.BoardButtons,e.getContext());console.log("Context for board buttons: ",r);const s=t(i).authors.map((e=>({text:e.title,callback:async(t,r)=>{await t.set(a,o,n,e);const l=await t.get(a,o,n);console.log("return saved author: ",l)}})));return[{text:"Challenge Toolbox",callback:e=>(e=>(console.log("t in onBtnClick: ",e),e.popup({title:"Toolbox preferences",items:s})))(e),condition:l.default.Condition.Always}]};l=r("LdkDU");var c=r("BvQ1f");const d=(e,t)=>(async e=>{const t=l.default.Scope.Card,a=l.default.Visibility.Shared,o=l.default.Key.LogEntries,n=l.default.Capability.CardBadges,r=await e.get(t,a,o);console.log(`Data stored for ${o} against ${t} with ${a} access for ${n}  : `,r);const i=e.getContext();console.log("Context for card badges: ",i);const{challenges:s,celebrations:d}=c.default.getChallengeBadgeCounts(i,r),u=c.default.getButtonText(l.default.Type.Challenge,s),f=c.default.getButtonText(l.default.Type.Celebrate,d);if(console.log(`Current value for ${o} for card-badges`,r),0===s&&0===d)return[];const g=[{text:u,color:"red"},{text:f,color:"green"}],p=[];return 0!==s&&p.push(g[0]),0!==s&&p.push(g[1]),e.card("id","name").then((function(e){return p}))})(e);l=r("LdkDU"),c=r("BvQ1f");const u=(e,t)=>(async e=>{const t=l.default.Scope.Card,a=l.default.Visibility.Shared,o=l.default.Key.LogEntries,n=l.default.Capability.CardButtons,r=await e.get(t,a,o);console.log(`Data stored for ${o} against ${t} with ${a} access for ${n}  : `,r);const i=e.getContext();console.log("Context for card badges: ",i);const{challenges:s,celebrations:d}=c.default.getChallengeBadgeCounts(i,r),u=c.default.getButtonText(l.default.Type.Challenge,s),f=c.default.getButtonText(l.default.Type.Celebrate,d),g=e=>{console.log("onCloseChallengToolbox")},p=await e.card("name").get("name");return console.log("card: ",JSON.stringify(p,null,2)),[{icon:"https://cdn.hyperdev.com/us-east-1%3A3d31b21c-01a0-4da2-8827-4bc6e88b7618%2Ficon-gray.svg",text:u,condition:l.default.Condition.Always,callback:function(e){return e.modal({title:"Challenge",args:{type:l.default.Type.Challenge},url:"./modals/challenge.html",fullscreen:!1,height:500,callback:g})}},{icon:"https://cdn.hyperdev.com/us-east-1%3A3d31b21c-01a0-4da2-8827-4bc6e88b7618%2Ficon-gray.svg",text:f,condition:l.default.Condition.Always,callback:function(e){return e.modal({title:"Celebrate",args:{type:l.default.Type.Celebrate},url:"./modals/celebrate.html",fullscreen:!1,height:500})}}]})(e);l=r("LdkDU");r("bDs4w");c=r("BvQ1f"),l=r("LdkDU");var f={Authors:Object.freeze({RTW:"rtw",Spotify:"spotify",SWM:"swm",PrinciplesGreen:"pg",Princeton:"princeton"}),Environments:Object.freeze({Trello:"Trello"})};r.register("1L4ef",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("bJmGX")).then((()=>r("b6NUa")))})),r.register("aL8Qr",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("7WKo9")).then((()=>r("bEksa")))})),r.register("aHNJm",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("cX2tx")).then((()=>r("bmO0s")))})),r.register("hL96R",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("irEM1")).then((()=>r("f1e8W")))})),r.register("4Fu9l",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("2Ywgl")).then((()=>r("ffvez")))})),r.register("MsWMT",(function(e,t){e.exports=import("./"+r("bXuNP").resolve("cHbDk")).then((()=>r("epFvb")))}));const g=async e=>{let t,a;return(async()=>{switch(e){case f.Authors.RTW:return t=await r("1L4ef"),a=await r("aL8Qr"),{...t,...a};case f.Authors.Spotify:return t=await r("aHNJm"),a=await r("hL96R"),{...t,...a};case f.Authors.SWM:return t=await r("4Fu9l"),{...t,...a};case f.Authors.Princeton:return t=await r("MsWMT"),{...t,...a}}})()};var p={getTrelloData:async e=>{const t=e.id;return await g(t)},getAuthorDataById:g};var b={getData:async e=>await p.getAuthorDataById(e.id),getCapabilityPreferences:(e,t)=>{const a=e.capabilities.find((e=>e.capability===t));return a&&a.enabled?a.labels:[]},getTrelloLabels:async({pledges:e,log:t,context:a,popup:o=null})=>(console.log("getTrelloLabels log: ",t),o?e.map((e=>({text:`${e.text} ${c.default.getCustomBadgeCounts(a,t,e)}`,condition:l.default.Condition.Always,callback:e=>((e,t,a)=>e.popup({title:a.prompt,items:a.effects}))(e,0,o)}))):e.map((e=>({text:e.text,condition:l.default.Condition.Always,callback:t=>(async(e,t,a)=>{const o=new c.default,{isPledgeNowLogged:n,updatedPledges:r}=o.togglePledge(t,a);return await e.set(scope,visibility,key,r),await e.get(scope,visibility,key)})(t,a,e)})))),getPopup:async e=>{const t=e.popup;return!t||t&&!t.enabled?null:t}};const y=(e,t)=>(async e=>{const t=e.getContext(),a=await e.get(l.default.Scope.Card,l.default.Visibility.Shared,l.default.Key.LogEntries);let o;a&&void 0!==a&&(o=challengeLog.setLog(a));const n=await e.get(l.default.Scope.Board,l.default.Visibility.Shared,l.default.Key.ChallengePreferences),r=await b.getData(n),i=await b.getCapabilityPreferences(r,l.default.Capability.CardDetailBadges);return await b.getTrelloLabels({pledges:i,log:o,context:{board:t.board,card:t.card,member:t.member}})})(e);window.TrelloPowerUp.initialize({"board-buttons":(e,t)=>((e,t)=>s(e))(e),"card-badges":(e,t)=>d(e),"card-buttons":(e,t)=>u(e),"card-detail-badges":(e,t)=>y(e)});
//# sourceMappingURL=index.f768ac79.js.map
